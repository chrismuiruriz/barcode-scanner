var $$=Dom7;$mainUrl="http://dev.bean.co.ke/smollan-api/api/";var theme="auto";if(document.location.search.indexOf("theme=")>=0){theme=document.location.search.split("theme=")[1].split("&")[0]}var app=new Framework7({theme:"md",init:false,cache:false,view:{pushState:true},root:"#app",name:"SMOLLAN",id:"co.ke.smollan",panel:{swipe:"right"},routes:routes});var $$=app.$;if(app.device.desktop){app.dialog.alert("We've detected you are using a desktop device to view this app, for the best user experience, kindly view it on your smartphone., ",null)}var mainView=app.view.create(".view-main");app.on("pageInit",function(b){var a=b.name;if(a!=="login"){if(!localStorage.login){mainView.router.load({url:"./pages/login-page.html",ignoreCache:true,reload:true})}}else{if(a==="login"){if(localStorage.login){mainView.router.load({url:"./index.html",ignoreCache:true,reload:true})}}}});app.on("pageBeforeIn",function(b){$(".panel-right").removeClass("opacity-none");$(".panel-backdrop").removeClass("opacity-none");var a=b.name;if(a==="login"){if(localStorage.login){mainView.router.load({url:"index.html",ignoreCache:true,reload:true})}}else{if(a==="cooler-details"){coolerDetailsFunctions(b)}}});var coolerDetailsFunctions=function(b){if($.isEmptyObject(b.route.params)){var c=b.route.query}else{var c=b.route.params}var d=c.code;var a=$mainUrl+"get_cooler.php";app.dialog.preloader("...");app.request.post(a,{code:d},function(f,e,h){app.dialog.close();if(f.status==="SUCCESS"){var g=JSON.parse(f.data);console.log(f.data);$("data-cooler=['serial']").html(g.ID);$("data-cooler=['name']").html(g.name);$("data-cooler=['location']").html(g.location);$("data-cooler=['img']").html("src",g.image)}else{app.dialog.alert(f.message,null)}},function(f,e){app.dialog.close();app.dialog.alert("Connection Error! Check your internet connection and try again.!",null)},"json")};$$("#main-panel").on("panel:open",function(){if(localStorage.userFirstName){$("[data-modal='panelUserFullName']").html(localStorage.name)}});$("body").on("submit","#login-form",function(d){d.preventDefault();var a=$("#login-email-input").val();var b=$("#login-password-input").val();if(a===""||b===""){app.toast.create({text:"Email or Password is missing!",position:"center",closeTimeout:2000}).open();return}else{var c=$mainUrl+"login.php";app.request.post(c,{email:a,password:b},function(f,e,h){app.dialog.close();if(f.status==="SUCCESS"){var g=JSON.parse(f.data);localStorage.login="true";localStorage.id=g.ID;localStorage.name=g.name;localStorage.email=g.email;console.log(f.data);app.dialog.alert(f.message,null,function(){mainView.router.load({url:"./index.html",ignoreCache:true,reload:true})})}else{app.dialog.alert(f.message,null)}},function(f,e){app.dialog.close();app.dialog.alert("Connection Error! Check your internet connection and try again.!",null)},"json")}});$("body").on("submit","#scan-qr-form",function(a){a.preventDefault();cordova.plugins.barcodeScanner.scan(function(b){var c="QR CODE "+b.text;app.dialog.alert(c,null,function(){var d="./pages/cooler-details.html?code="+b.text+"&serial=1";mainView.router.load({url:d,ignoreCache:true,reload:true})})},function(b){alert("Scanning failed: "+b)},{preferFrontCamera:false,showFlipCameraButton:true,showTorchButton:true,torchOn:false,prompt:"Place a the QR Code inside the scan area",resultDisplayDuration:500,orientation:"portrait",disableAnimations:true})});var questionPopup=app.popup.create({content:'<div class="popup"><form class="list" id="quiz-form"><h4 class="quiz-title">Fill in the form below and submit</h4><ul><li><div class="item-content"><div class="item-inner"><div class="item-title">Sheaves Properly Aligned?</div><div class="item-after"><label class="toggle toggle-init"><input type="checkbox" name="sheaves-aligned" value="yes"><i class="toggle-icon"></i></label></div></div></div></li><li><div class="item-content"><div class="item-inner"><div class="item-title">Is this cooler odor-less?</div><div class="item-after"><label class="toggle toggle-init"><input type="checkbox" name="cooler-odorless" value="yes"><i class="toggle-icon"></i></label></div></div></div></li><li><div class="item-content"><div class="item-inner"><div class="item-title">Is temp below 4.4 &#8451;</div><div class="item-after"><label class="toggle toggle-init"><input type="checkbox" name="temp-below-10" value="yes"><i class="toggle-icon"></i></label></div></div></div></li><li><div class="item-content item-input"> <div class="item-inner"><div class="item-title item-label">Comment</div> <div class="item-input-wrap"> <textarea name="comment" placeholder="Your comment" rows="4"></textarea> </div> </div> </div> </li></ul><div class="quix-btn-container"><button class="col button button-fill" id="quiz-btn">SUBMIT</button></div></form><div class="block block-strong row"><div class="col"><a class="button fill-form-from-data" href="#" id="close-quiz-popup">Close</a></div></div></div>'});$("body").on("click","#close-quiz-popup",function(a){a.preventDefault();questionPopup.close()});$("body").on("click","#get-quiz-details",function(){questionPopup.open()});$("body").on("submit","#quiz-form",function(a){a.preventDefault()});app.init();